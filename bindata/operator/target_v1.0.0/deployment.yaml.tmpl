apiVersion: apps/v1
kind: Deployment
metadata:
  name: openshift-acme
  labels:
    app: openshift-acme
spec:
  selector:
    matchLabels:
      app: openshift-acme
  replicas: 2
  strategy:
    type: RollingUpdate
  template:
    metadata:
      labels:
        app: openshift-acme
    spec:
      serviceAccountName: openshift-acme
      containers:
      - name: openshift-acme
        image: {{ .ControllerImage }}
        imagePullPolicy: Always
        args:
        - --exposer-image={{ .ExposerImage }}
        - --loglevel=4
{{- if not .ClusterWide }}
        - --namespace=$(CURRENT_NAMESPACE)
  {{- range .AdditionalNamespaces }}
        - --namespace={{ . }}
  {{- end }}
        env:
        - name: CURRENT_NAMESPACE
        valueFrom:
        fieldRef:
        fieldPath: metadata.namespace
{{ end -}}
